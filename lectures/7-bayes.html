<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Introduction to Bayesian Statistics</title>
    <meta charset="utf-8" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/rladies.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/rladies-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Introduction to Bayesian Statistics

---




## Frequentist Viewpoint

- Frequentist vs. Bayesian
- **Frequentist** view is sometimes called the "in the long run" view. It defines probability as what is expected to happen in the long run, if the event in question (e.g., tossing a coin, rolling a die) is repeated over and over. *(This is what we've been talking about)*

  - Ex: We know that a fair coin will come up on heads 50% of the time: `\(P(H) = .5\)`
  - A coin flipped a 2 times might come up heads both times (100%), but a head flipped 1000 times would not likely come up heads 1000 times. *In the long run, the proportion of heads will converge on the expected probability.*

---
## Frequentist Viewpoint

This "long run" view of probability means that in "short run" the outcomes will not behave as expected—the outcomes will show variability around the expected probability outcome. ]

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

The utility here is that we know what the truth is and can see how closely we approximate it in the long run, but also see what happens in realistic short run circumstances:

- Tossing a coin: proportion of heads, P(H) = .5

- Rolling a die: proportion of sixes, P(6) = .1666

- Selecting a Scrabble tile: proportion of Zs, P(Z)=.01

---

The frequentist view is popular because it is objective. The events in question are observable and the definition of probability (proportion of an event in the long run) is calculated in the same way by everyone.

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

On the other hand, in real life, "the long run" may not have a simple or realistic meaning: 

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

"The probability that Shelly has her phone with her today is .8, or 80%."

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

At one level, we all have an intuitive feel for what this means and understand it to tell us that Shelly likely does not have her phone.

---

But, in the strict sense, that statement doesn’t have a sensible meaning in the language of a frequentist view.

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

I either do or I do not have my phone with me today (there are only two outcomes in the sample space); it makes no sense to say that I have 80% of my phone with me today and the event is not repeatable (having my phone today) in the strict sense, so the “long run” doesn’t seem to apply.

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

Instead, we have to say something like, on days like today (which can be repeated), the probability that Shelly has her phone with her is .8.  

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

Probability and statistics involve many such convenient fictions...

???

They allow us to get on with the job of forecasting from models to data or making inferences when going from data to models.

---

The link between probability and statistics is clear when we make the move to inference—the major task in science.

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

In probability, the model (the probability distribution, the generating function) is known and informs us what will be true about the data.  

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

In statistical inference, the model is not known and we let the data inform us about the plausibility of different models that might be true.  

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

We have to make assumptions about those models in order to sensibly answer the inference question.

---

If this coin is fair (proposed model), I expect the proportion of heads to be .5 in the long run.

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

After a long run (data collection), I find the proportion of heads to be .75.  I reject the "fair coin model."  I could be wrong but will try to limit the mistakes.  

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

This is statistical inference.  It relies upon assuming some generating process for the events (a model), typically defined by a theoretical probability distribution (here the binomial).  That framework allows us know the likelihood that we are wrong in our inference, especially in the short run.

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

Probability and probability distributions provide a frame of reference for making inferences.

---

### Distributions and their distinctions.

**Population distribution:** the usually hypothetical set of all possible measurements.  

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

- In the frequentist view this would be an infinitely long series of events.  

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

- In practice, we have to settle for “really long.”

&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;

**Sample distribution:** the set of measurements in hand, assumed to be a random sample from the population. 

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

- I will use statistics about the sample to infer what is true about population parameters.

---

### Distributions and their distinctions.

**Sampling distribution:** Any sample will be off the mark in the value of a statistic relative to the population.  These statistic values will have a distribution across different random samples of the same size from the same population.  The variability in that distribution will tell us about the precision of the sample as a population estimate and the confidence we can have in claims we make about parameters.

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

- Long run version (repeated sampling interpretation)

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

- Theoretical version

*More on both of these when we talk about sampling.*

---

## Bayesian statistics

In contrast to the frequentist view, the Bayesian view takes prior beliefs into account in determining the probability of an event.  

- It is a model of rational thinking that adjusts current beliefs about the probability of an event given previous knowledge or beliefs.  

- Because those prior beliefs could come from anywhere, the approach is sometimes labeled "subjectivist," but it need not be hopelessly subjective.

The key contribution can be summarized in Bayes’ Theorem:

`$$\Large \text{A given B} = P(A|B) = \frac{P(B|A)P(A)}{P(B|A)P(A) + P(B|\neg A)P(\neg A)}$$`

---

### Bayesian example

I have the personal theory that, generally speaking, Bayesians are smug.  I meet a smug person. What is the probability that I have met a Bayesian?

`$$\large \text{Bayesian | Smug} = P(B|S) = \frac{P(S|B)P(B)}{P(S|B)P(B) + P(S|\neg B)P(\neg B)}$$`
`\(P(B) = .1 \text{(Bayesian are not common, overall)}\)`

`\(P(S|B) = .8\)`

`\(P(S|\neg B) = .3\)`

`$$\large \text{Bayesian | Smug} = P(B|S) = \frac{(.8)(.1)}{(.8)(.1) + (.3)(.9)} = 0.229$$`
---

`\(P(B) = .1\)`

`\(P(S|B) = .8\)`

`\(P(S|\neg B) = .3\)`

`\(P(B|S) = 0.229\)`

From a pure baserate standpoint I should assume the probability is .1 that this person is a Bayesian.  Bayesian reasoning tells me to take my prior beliefs into account given what I believe to be true about the relation of smugness to Bayesian status.

&lt;p&gt;&amp;nbsp;&lt;/p&gt;
--
But, it also tells me not to be too enthusiastic about this Bayesian attribution.  I should not just flip around my conditional probability of "smugness given Bayesian" and claim the probability is .8 that I’ve just encountered a Bayesian. 

--
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
In the language of Bayes Theory, P(B) is called the **prior probability**, P(B|S) is the **posterior probability**, which is an adjustment of P(B) in the face of additional information (smugness).

---

The liberal sprinkling of the term, belief, in all this is what garners the label, subjectivist.

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

There is no need for P(B) or P(S|B) to be point estimates.  We can express uncertainty about these beliefs by making them *probability distributions*. The result is a posterior probability distribution.  I can use actual data to help me decide which of several different models about Bayesian-smugness beliefs is the better account.

&lt;p&gt;&amp;nbsp;&lt;/p&gt;

There is no controversy when the prior information is based on solid scientific evidence.

---

## Another Bayesian example

My doctor calls me with the results of a diagnostic test for a very rare but always fatal medical condition. I ask about the nature of the test and he tells me it has a sensitivity of .99 and specificity of .99, based on a large number of clinical studies.  How worried should I be? What is the probability that I will actually get this disease?

--

Assume that in the population, 1 out of every 10,000 people gets the condition: P(Disease) = .0001. 

The sensitivity tells me that P(Positive Test|Disease) is .99.

The specificity tells me that P(Positive Test|No Disease) is .01.

What is the probability that I will get this disease given that I have a positive test?  P(Disease|Positive Test) = .0098

???

Before transitioning, need to know probability of rare disease.

`$$\frac{(.99)(.0001)}{(.99)(.0001)+(.01)(.9999)}$$`

---
## `\(p\)`-values

Soon enough, we'll get to how `\(p\)`-values are derived from data. But it's worth bringing them up now, because they are statments about probability. 

What are `\(p\)`-values representing the probability of?

--

Which view of probability, frequentist or Bayesian, are `\(p\)`-values associated with?

---

## Likelihood under different views

.pull-left[
### Frequentist

`$$p = P(\text{Data}|H_0)$$`
]

.pull-right[
### Bayesian
`$$\text{Bayes Factor} = \frac{P(\text{Data}|H_A)}{P(\text{Data}|H_0)}$$`
]

Which is right?

* `\(p\)`-values and Bayes Factor are highly correlated ([Wetzels et al., 2011](../readings/Wetzels_etal_2011.pdf)).



???

Note that `\(H_A\)` can be a range of possible parameters, in which case, you get the weighted probability across many, or the integral if a continuous range. 

---

&lt;img src="images/BF_pvalue.png" width="75%" /&gt;

.small[([Wetzels et al., 2011](../readings/Wetzels_etal_2011.pdf))]

???
But major disagreement in conclusion.

- When `\(p\)`-value falls between .01 and .05, there is a 70% chance that Bayes Factor suggests only anecdotal evidence in favor of alternative. 

Take-away -- Bayes Factor is more conservative when it comes to finding evidence against the null hypothesis. Is that better, or worse?

---

class: inverse

## Next time...

Sampling distributions
`\(t\)`-distributions
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
