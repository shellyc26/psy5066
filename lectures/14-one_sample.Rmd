---
title: 'One-sample hypothesis tests'
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: [default, rladies, rladies-fonts, "my-theme.css"]
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
--- 

```{r, echo = F, results = 'hide', message = F, warning = F}
library(here)
library(tidyverse)
library(psych)
library(knitr)
```


## Today...

* One-sample *t*-tests

---

# What are the steps of NHST?

--

1. Define null and alternative hypothesis.

--

2. Set and justify alpha level.

--

3. Determine which sampling distribution ( $z$, $t$, or $\chi^2$ for now)

--

4. Calculate parameters of your sampling distribution under the null.
  * If $z$, calculate $\mu$ and $\sigma_M$

--

5. Calculate test statistic under the null.
  * If $z$, $\frac{\bar{X} - \mu}{\sigma_M}$
  
--

6. Calculate probability of that test statistic or more extreme under the null, and compare to alpha.

---

One-sample tests compare your given sample with a "known" population.

* Research question: does this sample come from this population?

**Hypotheses**

$H_0$: Yes, this sample comes from this population.

$H_1$: No, this sample comes from a different population. 



---

The [sample data](../data/census_at_school.csv) were obtained from Census at School, a website developed by the American Statistical Association to help students in the 4th through 12th grades understand statistical problem-solving. 

  * The site sponsors a survey that students can complete and a database that students and instructors can use to illustrate principles in quantitative methods.  
  * The database includes students from all 50 states, from grade levels 4 through 12, both boys and girls,  who have completed the survey dating back to 2010.  
  
```{r, echo = F, message = F, warning = F}
school = read_csv(here("data/census_at_school.csv"))
school = school %>% filter(!is.na(Superpower))
```

---

### Comparing Means

Comparing means is usually done with the *t*-test, of which there are several forms.

The one-sample *t*-test is appropriate when a single sample mean is compared to a population mean but the population standard deviation is unknown.  A sample estimate of the population standard deviation is used instead.  The appropriate sampling distribution is the t-distribution, with N-1 degrees of freedom.

$$t_{df=N-1} = \frac{\bar{X}-\mu}{\frac{\hat{\sigma}}{\sqrt{N}}}$$
The heavier tails of the t-distribution, especially for small N, are the penalty we pay for having to estimate the population standard deviation from the sample.

---

### One-sample *t*-tests

*t*-tests were developed by William Sealy Gosset, who was a chemist studying the grains used in making beer. (He worked for Guinness.)

* Specifically, he wanted to know whether particular strains of grain made better or worse beer than the standard. 

* He developed the *t*-test, to test small samples of beer against a population with an unknown standard deviation.
  
  * Probably had input from Karl Pearson and Ronald Fisher
  
* Published this as "Student" because Guinness wouldn't let him share company secrets. 

---

### One-sample *t*-tests

We've already been covering one-sample *t*-tests, but let's formally walk through some of the steps and how this differs from a z-test.

| | Z-test | *t*-test |
| --|--------|--------|
| $\large{\mu}$ | known | known |
| $\sigma$ | known |unknown |
| sem or $\sigma_M$ | $\frac{\sigma}{\sqrt{N}}$ | $\frac{\hat{\sigma}}{\sqrt{N}}$ |
|Probability distribution | standard normal | t |
| DF | none | N-1 |
| Tails | One or two | One or two |
| Critical value ( $\alpha = .05, two-tailed$ | 1.96 | Depends on DF |

---

### When you assume...

...you can run a parametric statistical test!

**Assumptions of the one-sample *t*-test**

**Normality.** We assume the sampling distribution of the mean is normally distributed. Under what two conditions can we be assured that this is true?

**Independence.** Observations in the dataset are not associated with one another. Put another way, collecting a score from Participant A doesn't tell me anything about what Participant B will say. How can we be safe in this assumption?

---

### A brief example

Using the same Census at School data, we find that Oregon students who participated in a memory game ( $N = 227$ ) completed the game in an average time of 49.1 seconds ( $s = 13.4$ ). We know that the average US student completed the game in 45.04 seconds. How do our students compare?

--

**Hypotheses**

$H_0: \mu = 45.05$

$H_1: \mu \neq 45.05$

---

$$\mu = 45.05$$

$$N = 227$$

$$ \bar{X} = 49.1 $$

$$ s = 13.4 $$





```{r}
t.test(x = school$Score_in_memory_game, mu = 45.05, 
       alternative = "two.sided")
```


---

```{r}
lsr::oneSampleTTest(x = school$Score_in_memory_game, 
                    mu = 45.05, one.sided = FALSE)
```

---

# Cohen's D

Cohen suggested one of the most common effect size estimates—the standardized mean difference—useful when comparing a group mean to a population mean or two group means to each other. 

$$\delta = \frac{\mu_1 - \mu_0}{\sigma} \approx d = \frac{\bar{X}-\mu}{\hat{\sigma}}$$

--

Cohen’s d is in the standard deviation (Z) metric.


---

Cohens’s d for these data is .30.  In other words, the sample mean differs from the population mean by .30 standard deviation units. 

Cohen (1988) suggests the following guidelines for interpreting the size of d:

.large[

- 	.2 = Small

- 	.5 = Medium

- 	.8 = Large	

]
.small[Cohen, J. (1988), Statistical power analysis for the behavioral sciences (2nd Ed.). Hillsdale: Lawrence Erlbaum.]
---

Another useful metric is the overlap between the two distributions -- the smaller the overlap, the farther apart the distributions

```{r, echo = F, warning = FALSE, message=FALSE}
alt = mean(school$Score_in_memory_game, na.rm=T)
null = 45.05
se = sd(school$Score_in_memory_game, na.rm=T)/sqrt(length(which(!is.na(school$Score_in_memory_game))))

x = seq(from = 40, to = 55, by = .01)
d.alt = dnorm(x, mean = alt, sd = se)
d.nul = dnorm(x, mean = null, sd = se)

loc = min(which(d.alt-d.nul > 0))
loc = (x[loc] + x[loc-1])/2

area = pnorm(loc, mean = null, sd = se, lower.tail = F) + pnorm(loc, mean = alt, sd = se, lower.tail = T)

ggplot(data.frame(x=x), aes(x)) +
  stat_function(fun = function(x) dnorm(x, mean = null, sd = se), 
                geom = "area", xlim = c(loc,55), fill = "black") + 
  stat_function(fun = function(x) dnorm(x, mean = alt, sd = se), 
                geom = "area", xlim =c(45, loc), fill = "black") + 
  stat_function(fun = function(x) dnorm(x, mean = null, sd = se), geom = "line", aes(color = "null")) + 
  stat_function(fun = function(x) dnorm(x, mean = alt, sd = se), geom = "line", aes(color = "alternative")) + 
  scale_color_discrete("Model") +
  ggtitle(paste0("Overlap = ", round(area,3))) + 
  theme_bw(base_size = 20)
```


---

### The usefulness of the one-sample *t*-test

How often will you conducted a one-sample *t*-test on raw data?

--

* (Probably) never

How often will you come across one-sample *t*-tests?

--

* (Probably) a lot!

The one-sample *t*-test is used to test coefficients in a model. 

---

```{r}
model = lm(Petal.Width ~ Species, data = iris)
summary(model)
```

---

# Next time...

Comparing two means